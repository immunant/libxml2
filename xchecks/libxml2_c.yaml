# Cross-check configuration for C libxml2
---
# System header
- file: "**/bits/types/__locale_t.h"
  items:
    - item: defaults
      disable_xchecks: true

- file: "**/__stddef_max_align_t.h"
  items:
    - item: defaults
      disable_xchecks: true

- file: "**/bits/socket.h"
  items:
    - item: struct
      name: sockaddr_storage
      fields:
          __ss_padding: disabled

- file: "**/pthread.h"
  items:
      # The Rust version doesn't call `pthread_equal`, for some reason
      - item: function
        name: pthread_equal
        disable_xchecks: true

- file: "**/bits/types/struct_FILE.h"
  items:
      - item: struct
        name: _IO_FILE
        fields:
            _markers: disabled
            _codecvt: disabled
            _wide_data: disabled

      - item: struct
        name: _IO_FILE_complete
        fields:
            _markers: disabled
            _codecvt: disabled
            _wide_data: disabled

- file: "**/sys/stat.h"
  items:
      # On some systems, `stat` is an inline function in `sys/stat.h`
      - item: function
        name: stat
        disable_xchecks: true

      - item: function
        name: stat64
        disable_xchecks: true

# libxml2 files
- file: "xmlschemastypes.c"
  items:
    - item: struct
      name: _xmlSchemaValDate
      custom_hash: "xcheck_hash_xmlSchemaValDate"

    - item: struct
      name: _xmlSchemaValDecimal
      custom_hash: "xcheck_hash_xmlSchemaValDecimal"

- file: "xmlsave.c"
  items:
    - item: struct
      name: _xmlSaveCtxt
      fields:
          indent: disabled

- file: "debugXML.c"
  items:
    - item: struct
      name: _xmlDebugCtxt
      fields:
          shift: disabled

- file: "dict.c"
  items:
      # _xmlDictStrings->end points past the end of the array
      - item: struct
        name: _xmlDictStrings
        fields:
            end: disabled

# libxml2 headers
- file: "**/include/libxml/parser.h"
  items:
    - item: struct
      name: _xmlParserCtxt
      fields:
          inputTab: disabled
          space: disabled
          nodeInfo: disabled

- file: "**/include/libxml/tree.h"
  items:
    # Node fields outside common part
    - item: struct
      name: _xmlDoc
      fields:
          compression: disabled
          standalone: disabled
          intSubset: disabled
          extSubset: disabled
          oldNs: disabled
          version: disabled
          encoding: disabled
          ids: disabled
          refs: disabled
          URL: disabled
          charset: disabled
          dict: disabled
          psvi: disabled
          parseFlags: disabled
          properties: disabled

    - item: struct
      name: _xmlDtd
      fields:
          notations: disabled
          elements: disabled
          attributes: disabled
          entities: disabled
          ExternalID: disabled
          SystemID: disabled
          pentities: disabled

    - item: struct
      name: _xmlNode
      fields:
          ns: disabled
          content: disabled
          properties: disabled
          nsDef: disabled
          psvi: disabled
          line: disabled
          extra: disabled

- file: "**/include/libxml/schemasInternals.h"
  items:
    # These all overlap with each other in memory,
    # but have different layouts
    - item: struct
      name: _xmlSchemaType
      custom_hash: "xcheck_hash_xmlSchemaType"

    - item: struct
      name: _xmlSchemaAttribute
      custom_hash: "xcheck_hash_xmlSchemaAttribute"

    - item: struct
      name: _xmlSchemaWildcard
      custom_hash: "xcheck_hash_xmlSchemaWildcard"

    - item: struct
      name: _xmlSchemaAttributeGroup
      custom_hash: "xcheck_hash_xmlSchemaAttributeGroup"

    - item: struct
      name: _xmlSchemaElement
      custom_hash: "xcheck_hash_xmlSchemaElement"

    - item: struct
      name: _xmlSchemaFacet
      custom_hash: "xcheck_hash_xmlSchemaFacet"

    - item: struct
      name: _xmlSchemaNotation
      custom_hash: "xcheck_hash_xmlSchemaNotation"

# Our files
- file: "variadic.c"
  items:
    - item: defaults
      disable_xchecks: true

- file: "xchecks/xchecks.c"
  items:
    - item: defaults
      disable_xchecks: true
...
