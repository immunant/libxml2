# Cross-check configuration for C libxml2
---
# System header
- file: "**/bits/types/__locale_t.h"
  items:
    - item: defaults
      disable_xchecks: true

- file: "**/__stddef_max_align_t.h"
  items:
    - item: defaults
      disable_xchecks: true

- file: "**/bits/socket.h"
  items:
    - item: struct
      name: sockaddr_storage
      fields:
          __ss_padding: disabled

- file: "**/pthread.h"
  items:
      # The Rust version doesn't call `pthread_equal`, for some reason
      - item: function
        name: pthread_equal
        disable_xchecks: true

# libxml2 files
- file: "xmlschemastypes.c"
  items:
    - item: struct
      name: _xmlSchemaValDate
      custom_hash: "xcheck_hash_xmlSchemaValDate"

    - item: struct
      name: _xmlSchemaValDecimal
      custom_hash: "xcheck_hash_xmlSchemaValDecimal"

- file: "xmlsave.c"
  items:
    - item: struct
      name: _xmlSaveCtxt
      fields:
          indent: disabled

- file: "debugXML.c"
  items:
    - item: struct
      name: _xmlDebugCtxt
      fields:
          shift: disabled

- file: "parser.c"
  items:
    # Functions that return values in xmlChar** parameters
    - item: function
      name: xmlParseStringCharRef
      all_args: disabled

    - item: function
      name: xmlSplitQName
      all_args: disabled

    - item: function
      name: xmlParseEntityValue
      all_args: disabled

    - item: function
      name: xmlParseExternalID
      all_args: disabled

    - item: function
      name: xmlParseDefaultDecl
      all_args: disabled

    - item: function
      name: xmlParseStringEntityRef
      all_args: disabled

    - item: function
      name: xmlParseStringPEReference
      all_args: disabled

    - item: function
      name: xmlParseAttribute
      all_args: disabled

    - item: function
      name: xmlParseQName
      all_args: disabled

    - item: function
      name: xmlParseAttribute2
      all_args: disabled

    - item: function
      name: xmlParseStartTag2
      all_args: disabled

    - item: function
      name: xmlParseGetLasts
      all_args: disabled

- file: "dict.c"
  items:
      # _xmlDict::strings has pointers to uninitialized data
      - item: struct
        name: _xmlDict
        fields:
            strings: disabled

# libxml2 headers
- file: "**/include/libxml/parser.h"
  items:
    - item: struct
      name: _xmlParserCtxt
      fields:
          inputTab: disabled
          nodeTab: disabled

- file: "**/include/libxml/tree.h"
  items:
    # Node fields outside common part
    - item: struct
      name: _xmlDoc
      fields:
          intSubset: disabled
          extSubset: disabled
          oldNs: disabled
          version: disabled
          encoding: disabled
          ids: disabled
          refs: disabled
          URL: disabled
          dict: disabled
          psvi: disabled

    - item: struct
      name: _xmlDtd
      fields:
          notations: disabled
          elements: disabled
          attributes: disabled
          entities: disabled
          ExternalID: disabled
          SystemID: disabled
          pentities: disabled

    - item: struct
      name: _xmlNode
      fields:
          ns: disabled
          content: disabled
          properties: disabled
          nsDef: disabled
          psvi: disabled

# Our files
- file: "variadic.c"
  items:
    - item: defaults
      disable_xchecks: true

- file: "xchecks/xchecks.c"
  items:
    - item: defaults
      disable_xchecks: true
...
